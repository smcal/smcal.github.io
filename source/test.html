<!--
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" src="../libs/d3.js"></script>
</head>
<body>
<script type="text/javascript">

    //Width and height
    var w = 600;
    var h = 250;
    var dataset = [];
    var year = {};

    var q = d3.queue();
    q.defer(function (callback) {
        //d3.csv("../data/small.csv", function (res) {
        d3.csv("../data/CaliforniaFires.csv", function (res) {
            callback(null, res);
        });

    });

    q.await(restOfCode);

    function restOfCode(err, results)
    {
        //var year = {};

        for( var i = 0; i < results.length; ++i)
        {
            year[results[i].Fire_Year] = 1;
        }

        console.log(year);

        d3.select('body')
            .append('select')
            .attr('class', 'select');

        var myyear = [];
        for(var key in year)
        {
            myyear.push(key);

        }
        console.log(myyear);

        d3.select("select")
            .selectAll('option')
            .data(myyear).enter()
            .append("option")
            .text(function (d) {return d;

            });


        /*dataset = results;
        console.log(results);

        var xScale = d3.scaleBand()
            .domain(d3.range(dataset.length))
            .rangeRound([0, w])
            .paddingInner(0.05);

        var yScale = d3.scaleLinear()
            .domain([0, d3.max(dataset, function(d) { return d.Fire_Size; })])
            .range([0, h]);

        //Define key function, to be used when binding data
        var key = function(d) {
            return d.Fire_Year;
        };

        //Create SVG element
        var svg = d3.select("body")
            .append("svg")
            .attr("width", w)
            .attr("height", h);

        //Create bars
        svg.selectAll("rect")
            .data(dataset, key)
            .enter()
            .append("rect")
            .attr("x", function(d, i) {
                return xScale(i);
            })
            .attr("y", function(d) {
                return h - yScale(d.Fire_Size);
            })
            .attr("width", xScale.bandwidth())
            .attr("height", function(d) {
                return yScale(d.Fire_Size);
            })
            .attr("fill", function(d) {
                return "rgb(0, 0, " + (d.Fire_Size * 10) + ")";
            });

        //Create labels
        svg.selectAll("text")
            .data(dataset, key)
            .enter()
            .append("text")
            .text(function(d) {
                return d.Fire_Size;
            })
            .attr("text-anchor", "middle")
            .attr("x", function(d, i) {
                return xScale(i) + xScale.bandwidth() / 2;
            })
            .attr("y", function(d) {
                return h - yScale(d.Fire_Size) + 14;
            })
            .attr("font-family", "sans-serif")
            .attr("font-size", "11px")
            .attr("fill", "white");




        //On change, update styling
        d3.select("input")
            .on("change", function() {

                var threshold = +d3.select(this).node().Fire_Yeare;

                svg.selectAll("rect")
                    .attr("fill", function(d) {
                        return "rgb(0, 0, " + (d.Fire_Size * 10) + ")";
                    })
                    .filter(function(d) {
                        return d.Fire_Year <= threshold;
                    })
                    .attr("fill", "red");

            });*/
    };

</script>

</body>
</html>-->


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Wildfires</title>
    <script type="text/javascript" src="../libs/d3.js"></script>

    <style type="text/css">

        rect:hover {
            fill: orange;
        }

        #tooltip {
            position: absolute;
            width: 200px;
            height: auto;
            padding: 10px;
            background-color: white;
            -webkit-border-radius: 10px;
            -moz-border-radius: 10px;
            border-radius: 10px;
            -webkit-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);
            -moz-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);
            box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);
            pointer-events: none;
        }

        #tooltip.hidden {
            display: none;
        }

        #tooltip p {
            margin: 0;
            font-family: sans-serif;
            font-size: 16px;
            line-height: 20px;
        }

    </style>

</head>
<body>

<div id="tooltip" class="hidden">
    <p><strong>Total Acres Burned from <span id="value">blah</span></strong></p>
</div>
<div>
<div>
<script type="text/javascript">
    // Your beautiful D3 code will go here

    var w = 600;
    var h = 650;
    var count = 0;
    var firesize = [];
    var xScale;


    var dataset = [];
    var dataset2 = [];
    var xScale, yScale;
    var dataSumYearCause = [];
    var dateParse = d3.timeFormat("%B %d, %Y");
    var dateMonthYear = d3.timeFormat("%B, %Y");

    var dateCalc = function( year, dayOfyear )
    {
        var temp = new Date( year );

        return temp.setDate(temp.getDate() + dayOfyear);
    };



    var q = d3.queue();
    q.defer(function (callback) {
        //d3.csv("../data/small.csv", function (res) {
        d3.csv("../data/CaliforniaFires.csv", function (res) {
            callback(null, res);
        });

    });

    q.await(restOfCode);

    function restOfCode(err, results)
    {
        for( var i = 0; i < results.length; ++i )
        {
            if(!isNaN(dataset[results[i].Fire_Cause]))
            {
                //dataset[[rows[i][3], rows[i][7]]] += Math.floor(Math.round(parseFloat(rows[i][2])));
                dataset[results[i].Fire_Cause] += Math.floor(Math.round(parseFloat(results[i].Fire_Size)));
            }
            else
            {
                //dataset[[rows[i][3], rows[i][7]]] = 0;
                dataset[results[i].Fire_Cause] = 0;
            }
        }


        var xAxis = d3.axisBottom()
            .scale(xScale);

        var test = [];
        for (var key in dataset)
        {
            firesize.push(dataset[key]);
            test.push({"key": key, "value": dataset[key]});
            count++;
        }

        var key = function(d) {
            return d.value;
        };
        var xScale = d3.scaleBand()
            .domain(d3.range(count))
            .rangeRound([0, w])
            .paddingInner(0.05);

        var xScale2 = d3.scaleTime()
            .domain([new Date(2018,0,1), new Date(2018,11,31)])
            .range([30, w - 30]);


        var xAxis = d3.axisBottom()
            .scale(xScale2)
            .tickFormat(d3.timeFormat("%B"));

        var yScale = d3.scaleLinear()
            .domain([0, d3.max(firesize)])
            .range([0, h]);

        var svg = d3.select("body")
            .append("svg")
            .attr("width", w)
            .attr("height", h);

        //Create bars
        svg.selectAll("rect")
            .data(test,key)
            .enter()
            .append("rect")
            .attr("x", function(d, i) {
                return xScale(i);
            })
            .attr("y", function(d) {
                return h - 30 - yScale(d.value);
            })
            .attr("width", xScale.bandwidth())
            .attr("height", function(d) {
                return yScale(d.value);
            })
            .attr("fill", function(d) {
                return "rgb(0, 0, " + Math.round(d.value * 10) + ")";
            })
            .on("mouseover", function(d) {

                //Get this bar's x/y values, then augment for the tooltip
                var xPosition = parseFloat(d3.select(this).attr("x")) + xScale.bandwidth() / 2;
                var yPosition = parseFloat(d3.select(this).attr("y")) / 2 + h / 2;

                //Update the tooltip position and value
                d3.select("#tooltip")
                    .style("left", xPosition + "px")
                    .style("top", yPosition + "px")
                    .select("#value")
                    .text(d.key + " " + d.value);

                //Show the tooltip
                d3.select("#tooltip").classed("hidden", false);

            })
            .on("mouseout", function() {

                //Hide the tooltip
                d3.select("#tooltip").classed("hidden", true);

            })
            .on("click", function() {
                sortBars();
            });

        //Define sort order flag
        var sortOrder = true;


        //Define sort function
        var sortBars = function() {

            //Flip value of sortOrder
            sortOrder = !sortOrder;

            svg.selectAll("rect")
                .sort(function (a, b) {
                    if (sortOrder) {
                        return d3.ascending(a.value, b.value);
                    } else {
                        return d3.descending(a.value, b.value);
                    }
                })
                .transition()
                .delay(function (d, i) {
                    return i * 50;
                })
                .duration(1000)
                .attr("x", function (d, i) {
                    return xScale(i);
                });
        }

        sortBars();

        svg.append("g")
            .attr("class", "axis")
            .attr("transform", "translate(0," + (h - 20) + ")")
            .call(xAxis);
    };


</script>

</div>
    <div><p>another test</p></div>
    <div><p>another test</p></div>
</div>

</body>
</html>